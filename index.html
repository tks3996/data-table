<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JQuery Data Table</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

   <link rel="stylesheet" href="./css/style.css">

    <script src="./script/script.js"></script>
</head>

<body>
    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <span id="closeModal" class="close-btn">×</span>
            <h3>Welcome! New Features Added</h3>
            <ul>
                <li><strong>Create New Table:</strong> Click "New Table" to start with a default table.</li>
                <li><strong>Create New Sheet:</strong> Click "New Sheet" to add a new sheet with a custom name.</li>
                <li><strong>Edit Column Names:</strong> Double-click column headers in "Edit Mode" to rename them
                    directly.</li>
                <li><strong>Hover to Add Rows/Columns:</strong> Hover over column headers or row numbers to see a "+"
                    button. Click to add a new column (left/right) or row (before/after).</li>
                <li><strong>Hover to Delete Rows/Columns:</strong> Hover over column headers or row numbers to see a "−"
                    button. Click to delete that column or row.</li>
                <li><strong>Custom Export File Name:</strong> When exporting to Excel or PDF, you’ll be prompted to
                    enter a custom file name.</li>
                <li><strong>Save Before Clear:</strong> When clicking "Clear," you'll be prompted to save the table as
                    an Excel file before clearing.</li>
                <li><strong>Welcome Popup:</strong> This popup! It lists new features on page load (shows only thrice per
                    session).</li>
            </ul>
        </div>
    </div>

    <div class="sticky-top">
        <div id="editStatus"></div>
        <div id="editInstruction"></div>
        <div class="undo-redo-box">
            <button id="undoBtn" onclick="undo()"><span>↶</span> Undo</button>
            <button id="redoBtn" onclick="redo()">Redo <span>↷</span></button>
        </div>

        <h2>Swipewire</h2>
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div class="attach-file-box">
                <input type="file" id="excelFile" accept=".xlsx, .xls">
                <button onclick="clearTable()" class="clear">Clear</button>
            </div>

            <div class="btn-container">
                <button id="editBtn" onclick="toggleEdit()">Edit</button>
                <button onclick="createNewTable()" class="new-table">New Table</button>
                <button onclick="createNewSheet()" class="new-sheet">New Sheet</button>
                <button onclick="exportToExcel()">Export to Excel</button>
                <button onclick="exportToPDF()">Export to PDF</button>
            </div>
        </div>
    </div>
    <table id="dataTable" class="display" style="width:100%; overflow: scroll;">
        <thead></thead>
        <tbody></tbody>
    </table>
</body>

</html>